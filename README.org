
#+TITLE: Gestione Emergenze Protezione Civile
#+AUTHOR: Davide Peressoni

Applicazione gestionale delle emergenze per le squadre locali di Protezione Civile.

* Indice :TOC:
- [[#guida-alluso][Guida all'uso]]
  - [[#gestione-emergenze][Gestione emergenze]]
  - [[#gestione-interventi][Gestione interventi]]
  - [[#visualizzare-gli-interventi][Visualizzare gli interventi]]
  - [[#cambio-cartografia][Cambio cartografia]]
  - [[#gestione-dello-storico][Gestione dello storico]]
  - [[#amministrazione][Amministrazione]]
  - [[#impostazioni][Impostazioni]]
- [[#compilazione-e-installazione][Compilazione e installazione]]
  - [[#compilazione][Compilazione]]
  - [[#prerequisiti][Prerequisiti]]
  - [[#installazione][Installazione]]
- [[#licenza][Licenza]]

* Guida all'uso
#+CAPTION: Schermata principale
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_134506.png]]

** Gestione emergenze
*** Creare un'emergenza
È possibile creare un'emergenza premendo il pulsante blu =+ Emergenza= o durante la creazione di un intervento.

Le emergenze contengono uno o più [[*Gestione interventi][interventi]] correlati.

*** Chiudere un'emergenza
Quando tutti i suoi interventi sono finiti, per chiudere un'emergenza premere il pulsante arancione =Chiudi emergenza=.

Le emergenze chiuse sono sempre visibili nello [[*Gestione dello storico][storico]].

[[*Indice][Torna all'indice]]

** Gestione interventi
*** Creare un intervento
È possibile creare un intervento premendo il pulsante blu =+ Intervento=.

#+CAPTION: Creazione intervento
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_134246.png]]

Compariranno dei campi per creare l'intervento:
- nome intervento
- [[*Gestione emergenze][emergenza]] a cui appartiene l'intervento
- tipo di intervento
- indirizzo
- posizione GPS (fare click sulla mappa per inserirla ed eventualmente trascinare la puntina sul punto esatto)
- contatto
- risorse usate
- eventuali note

Al termine premere il pulsante verde =Crea=.

** Visualizzare gli interventi
Gli interventi sono visibili nella barra laterale sinistra all'interno della relativa emergenza e anche sulla mappa (come puntine). Premendo su un intervento nella barra laterale la mappa verrà centrata sulla posizione dell'intervento. premendo sulla puntina verranno mostrate le informazioni sull'intervento

#+CAPTION: Informazioni intevento
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_134428.png]]

*** Stato di un intervento
Un intervento può avere 3 stati:
1. Creato (blu)
2. Preso in carico (rosso)
3. Finito (grigio)

Per avanzare di stato usare l'apposito pulsante nella nuvoletta informativa dell'intervento che compare premendo sulla puntina dell'evento.

*** Spostare un intervento
Nella nuvoletta informativa dell'intervento che compare premendo sulla puntina dell'evento, premere il pulsante con quattro frecce in alto a destra. Muovere la puntina e salvare la nuova posizione.

*** Modificare un intervento
Nella nuvoletta informativa dell'intervento che compare premendo sulla puntina dell'evento, premere il pulsante con una penna su cella in alto a destra. Effettuare le modifiche alle informazioni dell'intervento. Alla fine premere il pulsante verde =Salva=.

#+CAPTION: Modifica intevento
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_134446.png]]

[[*Indice][Torna all'indice]]


** Cambio cartografia
Per cambiare cartografia utilizzare il pulsante in alto a destra nella mappa.

Sono disponibili 3 cartografie:
- stradale
- satellitare
- ibrida

#+CAPTION: Cambio cartografia
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_120711.png]]

[[*Indice][Torna all'indice]]

** Gestione dello storico
Per aprire lo storico andare nel menù =Strumenti= e selezionare la voce =Tutte le emergenze=, in alternativa usare la scorciatoia ~Ctrl+E~.

Verrà mostrato il riepilogo di tutte le emergenze con i relativi interventi e dettagli. È possibile inoltre riaprire un'emergenza chiusa in anticipo premendo il pulsante rosso =Riapri=, come stampare il riepilogo di un'emergenza premendo il pulsante bianco =Stampa= sempre a destra dell'emergenza.

#+CAPTION: Storico emergenze
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121339.png]]

È possibile filtrare le emergenze per nome e/o per anno utilizzando la ricerca veloce in alto a destra. per una ricerca più approfondita si può utilizzare la ricerca avanzata che permette di trovare (ed eventualmente filtrare) tutti gli interventi in cui è stata coinvolta una particolare risorsa (anche volontari) e di stampare un riepilogo della ricerca.

#+CAPTION: Ricerca avanzata
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121425.png]]

[[*Indice][Torna all'indice]]

** Amministrazione
*** Gestione risorse
Per aprire il gestore delle risorse andare nel menù =Strumenti= e selezionare la voce =Gestione risorse=, in alternativa usare la scorciatoia ~Ctrl+R~.

#+CAPTION: Apertura gestione risorse
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_120840.png]]

Le risorse gestibili sono:
- tipi di intervento
- volontari del gruppo di Protezione Civile (risorse umane)
- attrezzatura disponibile
- mezzi disponibili

#+CAPTION: Gestione risorse
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121056.png]]

**** Aggiunta risorse
Per aggiungere una risorsa scrivere il nome nella casella di testo nella sezione adeguata, successivamente premere il tasto ~Invio] o il pulsante blu =+=. Al termine premere il pulsante verde =Salva=.

**** Modifica di una risorsa
Per modificare il nome di una risorsa è sufficiente premere il pulsante di modifica (penna su cella blu) a destra della risorsa, modificare il nome nella casella di testo che comparirà e infine salvare la modifica premendo il tasto ~Invio~ o cliccando lo stesso pulsante.

#+CAPTION: Modifica risorsa
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121138.png]]

Se la modifica è finita premere il pulsante verde =Salva=, altrimenti effettuare altre modifiche o per annullare la modifica premere la freccia blu a destra della risorsa modificata. È possibile modificare più risorse prima di salvare. Per annullare tutte le modifiche premere =Annulla=.

#+CAPTION: Annulla modifica risorsa
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121209.png]]

**** Eliminare una risorsa
Per eliminare una risorsa è sufficiente premere il pulsante di cancellazione (cestino rosso) a destra della risorsa. La risorsa eliminata sarà mostrata barrata fino al salvataggio.

#+CAPTION: Eliminazione risorsa
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_121218.png]]

Se la modifica è finita premere il pulsante verde =Salva_= altrimenti effettuare altre modifiche o per annullare l'eliminazione premere la freccia rossa a destra della risorsa eliminata. È possibile modificare più risorse prima di salvare. Per annullare tutte le modifiche premere =Annulla=.

[[*Indice][Torna all'indice]]

** Impostazioni
Per aprire le impostazioni andare nel menù =Strumenti= e selezionare la voce =Impostazioni=, in alternativa usare la scorciatoia ~Ctrl+I~.

#+CAPTION: Impostazioni
[[https://dpdmancul.gitlab.io/gepc_screenshoots/Screenshot_20200828_120936.png]]

Qui si potrà:
- cambiare il nome del gruppo di Protezione Civile (ricordarsi di premere il pulsante adiacente per salvare il cambiamento)
- impostare la visuale di default della mappa nella posizione attuale (per quando viene aperto l'applicativo)
- effettuare un backup (si consigliare di effettuare periodicamente un backup e salvarlo su un supporto esterno conservato in un'altra struttura e di mantenere le ultime copie di backup)
- ripristinare un backup (si consiglia di contattare lo sviluppatore in questa evenienza)

[[*Indice][Torna all'indice]]

* Compilazione e installazione
** Compilazione
La compilazione di questo programma è gestita da =npm=.

Per installare le dipendenze lanciare:
#+begin_src sh
npm install
#+end_src

Per testare questo programma dare:
#+begin_src sh
npm test
#+end_src
Per generare l'eseguibile installabile:
#+begin_src sh
npm run build
#+end_src

I limiti della cartografia vanno impostati nel file app/Home/MapController.js:
#+begin_src js
$scope.maxbounds={
  southWest: {
    lat: 45.5275,
    lng: 11.7279
  },
  northEast: {
    lat: 46.6984,
    lng: 14.5184
  }
}
#+end_src

** Prerequisiti
Per poter eseguire questo programma è necessario un server MySQL.

** Installazione
1. Avviare =gepc_0.1.1_installer_x64.exe=;
2. Al termine verrà segnalato erroneamente un errore: premere "close" e chiudere l'applicazione;
3. Installare la cartografia:
   a. Scaricare (ad esempio da [[https://github.com/species/osm-tiledownloader][Open Street Maps]][fn:: Bisogna scegliere il server da cui scaricare le tiles con l'argomento --url (qui un elenco dei server: https://wiki.openstreetmap.org/wiki/Tiles e https://wiki.openstreetmap.org/wiki/Aerial_imagery). Inoltre coi parametri --min-zoom e --max-zoom si deve impostare i livelli di zoom da scaricare (ad esempio 13 e 14 per il satellitare e da 12 a 15 per lo stradale). Con i parametri --top, --bottom, --left e --right si restringe la zona da scaricare (qui si possono trovare i valori: https://www.openstreetmap.org/export)]) la zona desiderata
   b. Inserirla nelle cartelle "stradale" e "satellitare" nella cartella in cui è stato installato il programma (=C:\Users\nome_utente\AppData\Local\gestione-emergenze-protezione-civile=).
4. Al primo avvio verranno chiesti i dati di connessione al database MySQL.

[[*Indice][Torna all'indice]]

* Licenza
Questo software è distribuito con licenza [[file:LICENSE][AGPL 3.0]]

[[*Indice][Torna all'indice]]
